from django.shortcuts import render,redirect
from pymetasploit3.msfrpc import MsfRpcClient

def select_exploit(request,name):
    client = MsfRpcClient('pass',ssl=False)
    info = request.session["info"] if "info" in request.session else {}
    if request.method == 'POST':
        request.session['exploit'] = request.POST['exploit']
        request.session['command'] = f"use {request.POST['exploit']} ;"
        return redirect('options')
    fil = list(filter(lambda x: name in x,client.modules.exploits))
    return render(request,'select_exploit.html',{'exploit':fil if len(fil) > 0 else client.modules.exploits})

